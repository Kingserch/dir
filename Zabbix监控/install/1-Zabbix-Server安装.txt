Zabbix-Server服务端安装
1)配置时间同步
yum install ntp -y 
systemctl enable ntpd
systemctl start ntpd

2)客户端安装zabbix
rpm -Uvh https://repo.zabbix.com/zabbix/4.0/rhel/7/x86_64/zabbix-release-4.0-1.el7.noarch.rpm
yum install -y zabbix-server-mysql zabbix-web-mysql zabbix-agent zabbix-get

3)数据库操作
create database zabbix character set utf8 collate utf8_bin;  #创建zabbix数据库
grant all privileges on zabbix.* to zabbix@localhost identified by 'zabbix'; #授权zabbix用户从localhost访问，对zabbix数据库有完全控制权限
flush privileges;
zcat /usr/share/doc/zabbix-server-mysql*/create.sql.gz | mysql -uzabbix -p zabbix #初始化数据库结构并导入数据

4)配置zabbix_server.conf
[root@s-30 /]# egrep -v "^#|^$" /etc/zabbix/zabbix_server.conf
LogFile=/var/log/zabbix/zabbix_server.log
LogFileSize=0
PidFile=/var/run/zabbix/zabbix_server.pid
SocketDir=/var/run/zabbix
DBHost=localhost				#需要修改
DBName=zabbix				#默认
DBUser=zabbix				#默认
DBPassword=zabbix				#连接数据库的密码
SNMPTrapperFile=/var/log/snmptrap/snmptrap.log
Timeout=4
AlertScriptsPath=/usr/lib/zabbix/alertscripts
ExternalScripts=/usr/lib/zabbix/externalscripts
LogSlowQueries=3000

#更改时区，让时间同步
vim /etc/httpd/conf.d/zabbix.conf
php_value date.timezone Asia/shanghai

启动zabbix
systemctl start zabbix-server
systemctl enable zabbix-server

5)创建告警和扩展脚本目录(../install)
mkdir -p /etc/zabbix/alertsscripts  /etc/zabbix/externalscripts

6)如果关闭防火墙不需要配置下面，开启则需要(我维护的生产环境就没开selinux)
6.1)防火墙设置
#CentOS 7操作系统防火墙规则设置
firewall-cmd --permanent --add-port=80/tcp
firewall-cmd --permanent --add-port=10050/tcp
firewall-cmd --permanent --add-port=10051/tcp
firewall-cmd Creload
上述规则中，10050是Agent的端口，Agent采用被动方式，Server主动连接Agent的10050端口；10051是Server的端口，Agent采用主动或Trapper方式，会连接Server的10051端口。对于具有防火墙的网络环境，采取相同的防火墙规则策略即可。
6.2)SELinux的设置
如果操作系统已开启SELinux，则需要设置语句开启允许SELinux相关策略。
setsebool -P httpd_can_connect_zabbix on
setsebool -P httpd_can_network_connect_db on
关闭selinux
setenforce 0 	#0代表permissive，1代表enforcing；也可直接用permissive和enforcing，不用重启服务器即生效
sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config   #需要重启系统，永久关闭
getenforce 	#获取当前SELinux的运行状态


Zabbix-Web连接数据库和Zabbix-Server端口的相关配置信息如下：
[root@s-30 zabbix]# cat /etc/zabbix/web/zabbix.conf.php 
<?php
// Zabbix GUI configuration file.
global $DB;

$DB['TYPE']     = 'MYSQL';
$DB['SERVER']   = 'localhost';
$DB['PORT']     = '0';
$DB['DATABASE'] = 'zabbix';
$DB['USER']     = 'zabbix';
$DB['PASSWORD'] = 'zabbix';

// Schema name. Used for IBM DB2 and PostgreSQL.
$DB['SCHEMA'] = '';

$ZBX_SERVER      = 'localhost';
$ZBX_SERVER_PORT = '10051';
$ZBX_SERVER_NAME = 'zabbix';

$IMAGE_FORMAT_DEFAULT = IMAGE_FORMAT_PNG;

$ZBX_SERVER      = '127.0.0.1';
$ZBX_SERVER_PORT = '10051';
$ZBX_SERVER_NAME = 'zbx4';

$IMAGE_FORMAT_DEFAULT = IMAGE_FORMAT_PNG;